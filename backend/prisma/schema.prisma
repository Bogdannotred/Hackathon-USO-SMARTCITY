generator client {
  provider = "prisma-client-js"
  output   = "src/generated/client" //Specify the output directory
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           Int           @id @default(autoincrement())
  isAdmin      Boolean       @default(false)
  email        String        @unique
  name         String?
  password     String
  licensePlate String?
  balance      Float         @default(20)
  parkingSpace ParkingSpace? @relation("UserParkingSpace") // 1:1 relation
}

model ParkingLot {
  id              Int            @id @default(autoincrement())
  name            String         @unique // Add the unique constraint here
  location        String?
  geoLocation     Json? // GeoJSON field
  price           Float          @default(10)
  totalSpaces     Int            @default(0)
  availableSpaces Int            @default(0)
  parkingSpaces   ParkingSpace[] // 1:M relation
}

model ParkingSpace {
  id          Int     @id @default(autoincrement())
  name        String
  location    String?
  geoLocation Json?

  isAvailable Boolean   @default(true)
  expiresAt   DateTime?

  parkingLotId Int?
  ParkingLot   ParkingLot? @relation(fields: [parkingLotId], references: [id])

  lastUserId Int?  @unique
  lastUser   User? @relation("UserParkingSpace", fields: [lastUserId], references: [id])
}
